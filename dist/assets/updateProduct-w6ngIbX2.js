import{u as M,b as A,r as a,c as Q,d as z,e as B,j as t,n as p}from"./index-BB63jZdJ.js";const X=()=>{const{user:v,loading:G}=M(e=>e.userReducer),k=A(),C=new URLSearchParams(k.search).get("id"),[E,b]=a.useState(""),[D,m]=a.useState(""),[w,g]=a.useState(),[h,f]=a.useState(),[L,x]=a.useState(""),[N,d]=a.useState(""),[n,y]=a.useState(""),[u,j]=a.useState(0),[i,S]=a.useState(),[l,P]=a.useState(""),[c,R]=a.useState(""),[U,I]=a.useState(),[$,{isLoading:K,isError:O}]=Q(),[H,{isLoading:T,isError:V}]=z(),{data:s}=B(C);a.useEffect(()=>{b(s?.message._id),m(s?.message.name),g(s?.message.price),f(s?.message.stock),x(s?.message.category),d(s?.message.photo),y(s?.message.name),j(s?.message.price),S(s?.message.stock),P(s?.message.category)},[s]);const _=async()=>{let e=await $({email:v?.email,id:s?.message._id});if("data"in e&&p.success(e.data?e.data.message:"product deleted successfully"),"error"in e){const r=e.error,{data:o}=r;p.error(o.message)}y(""),j(0),S(0),P(""),b(""),m(""),g(0),f(0),x(""),d("")},q=async e=>{e.preventDefault();const r=new FormData;m(n),g(u),f(i),x(l),d(c),d(c),n&&r.set("name",n),u&&r.set("price",u.toString()),i&&r.set("stock",i.toString()),l&&r.set("category",l),U&&r.set("photo",U);let o=await H({id:s?.message?._id,email:v?.email,formdata:r});"data"in o&&p.success("Product updated successfully"),"error"in o&&p.error("Error while updating prodjuct")},F=e=>{const r=e.target.files?.[0],o=new FileReader;r&&(o.readAsDataURL(r),o.onloadend=()=>{typeof o.result=="string"&&(R(o.result),console.log("updated photo preview"+c),I(r))})};return t.jsxs("div",{className:"update-product",children:[t.jsxs("div",{className:"old-product",children:[t.jsxs("strong",{children:["ID - ",E]}),t.jsxs("h3",{children:["Name : ",D]}),t.jsx("img",{src:`http://localhost:4000/uploads/${N}`?`http://localhost:4000/uploads/${N}`:c,alt:"product-image"}),t.jsxs("h3",{children:["Price : ",w]}),t.jsxs("h3",{children:["Category : ",L]}),h>0?t.jsxs("span",{className:"green",children:["Stock : ",h]}):t.jsx("span",{className:"red",children:h}),t.jsx("button",{className:"delete-product-btn",onClick:_,children:"Delete"})]}),t.jsxs("form",{onSubmit:q,children:[t.jsx("input",{type:"text",placeholder:"Enter product name",value:n,onChange:e=>{y(e.target.value)}}),t.jsx("input",{type:"number",placeholder:"Enter product price",value:u,onChange:e=>{j(Number(e.target.value))}}),t.jsx("input",{type:"number",placeholder:"Enter product stock",value:i,onChange:e=>{S(Number(e.target.value))}}),t.jsx("input",{type:"text",placeholder:"Enter product category",value:l,onChange:e=>{P(e.target.value)}}),t.jsx("input",{type:"file",onChange:F}),c&&t.jsx("img",{src:c,alt:"New Image"}),t.jsx("button",{type:"submit",children:"Create"})]})]})};export{X as default};
